// Cookie Hook - 监控Cookie读写
(function() {
    let cookieDesc = Object.getOwnPropertyDescriptor(Document.prototype, 'cookie') ||
                     Object.getOwnPropertyDescriptor(HTMLDocument.prototype, 'cookie');

    if (cookieDesc && cookieDesc.configurable) {
        Object.defineProperty(document, 'cookie', {
            get: function() {
                let value = cookieDesc.get.call(document);
                console.log('[Cookie Get]', value);
                return value;
            },
            set: function(val) {
                console.log('[Cookie Set]', val);
                // 可在此处拦截特定cookie
                // if (val.includes('session')) { debugger; }
                return cookieDesc.set.call(document, val);
            },
            configurable: true
        });
    }

    console.log('[Hook] Cookie Hook 已注入');
})();
