# 加密算法识别指南

## 国标密码算法

### SM2 (非对称加密)
**特征识别：**
- 密钥长度：公钥64字节(未压缩)或33字节(压缩)，私钥32字节
- 签名长度：64字节 (r,s各32字节)
- 常见函数名：`sm2Encrypt`, `sm2Decrypt`, `sm2Sign`, `sm2Verify`
- 曲线参数：`sm2p256v1`

```javascript
// 典型调用特征
sm2.doEncrypt(msg, publicKey)
sm2.doDecrypt(cipher, privateKey)
```

### SM3 (哈希算法)
**特征识别：**
- 输出长度：32字节(256位)，十六进制64字符
- 常见函数名：`sm3`, `SM3Digest`, `sm3Hash`
- 分组长度：512位

```javascript
// 典型调用特征
SM3(message)
sm3.hash(data)
```

### SM4 (对称加密)
**特征识别：**
- 密钥长度：16字节(128位)
- 分组长度：16字节
- 常见模式：ECB, CBC
- 常见函数名：`sm4Encrypt`, `sm4Decrypt`, `SM4`

```javascript
// 典型调用特征
sm4.encrypt(data, key, {mode: 'cbc', iv: iv})
```

## 常见加密算法

### AES
**特征识别：**
- 密钥长度：16/24/32字节 (128/192/256位)
- IV长度：16字节
- 常见库：CryptoJS, forge, sjcl

```javascript
// CryptoJS特征
CryptoJS.AES.encrypt(message, key, {iv: iv, mode: CryptoJS.mode.CBC})
```

### RSA
**特征识别：**
- 密钥格式：PEM (-----BEGIN PUBLIC KEY-----)
- 常见库：jsencrypt, node-forge
- 输出长度：与密钥长度相关(1024/2048位)

```javascript
// JSEncrypt特征
new JSEncrypt().setPublicKey(pubKey)
encrypt.encrypt(data)
```

### MD5/SHA
**特征识别：**
- MD5输出：32字符hex
- SHA1输出：40字符hex
- SHA256输出：64字符hex

```javascript
// CryptoJS特征
CryptoJS.MD5(message).toString()
CryptoJS.SHA256(message).toString()
```

## 定位技巧

1. **搜索关键词**：`encrypt`, `decrypt`, `sign`, `hash`, `crypto`, `cipher`
2. **断点位置**：加密函数入口、JSON.stringify前、XHR send前
3. **调用栈回溯**：从加密结果往上追溯参数来源
